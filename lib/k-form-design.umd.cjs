(function(o,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(o=typeof globalThis<"u"?globalThis:o||self,e(o["k-form-design"]={},o.Vue))})(this,function(o,e){"use strict";var S=Object.defineProperty;var w=(o,e,s)=>e in o?S(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var C=(o,e,s)=>(w(o,typeof e!="symbol"?e+"":e,s),s);class s{constructor(){C(this,"components",{})}addComponent(r,l){this.components[r]=l}getComponents(){return this.components}getComponent(r){return this.components[r]}useAntd(r){const{Form:l,FormItem:d}=r;this.addComponent("Form",l),this.addComponent("FormItem",d)}}const i=new s,y=e.defineComponent({__name:"KFormItem",props:{record:{type:Object,require:!0},model:{type:Object},modelValue:{}},emits:["update:modelValue"],setup(a,{emit:r}){const l=a,d=i.getComponent("FormItem"),{record:n}=l,c=n.componentProps,g=i.getComponents()[n.component];function h(p){r("update:modelValue",p)}return e.onMounted(()=>{c.defaultValue&&h(c.defaultValue)}),(p,t)=>(e.openBlock(),e.createBlock(e.unref(d),e.mergeProps(e.unref(n),{name:e.unref(n).field}),{default:e.withCtx(()=>[e.renderSlot(p.$slots,e.unref(n).slot,{value:l.modelValue,model:l.model,record:e.unref(n)},()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(g)),e.mergeProps({style:{width:"100%"},value:l.model[e.unref(n).field],"onUpdate:value":t[0]||(t[0]=u=>l.model[e.unref(n).field]=u)},e.unref(c)),null,16,["value"]))])]),_:3},16,["name"]))}}),F=e.defineComponent({__name:"KFormBuild",props:{formSchema:{type:Object}},setup(a,{expose:r}){const l=a,d=i.getComponent("Form");let n=e.reactive({});const c=e.ref(null),k=e.computed(()=>{var t;return{...(t=l.formSchema)==null?void 0:t.config}});function g(){return new Promise(async(t,u)=>{var f;try{await((f=c.value)==null?void 0:f.validateFields()),t(n)}catch(m){u(m)}})}function h(t){Object.assign(n,t)}function p(t){return t||""}return r({getData:g,setData:h}),(t,u)=>(e.openBlock(),e.createBlock(e.unref(d),e.mergeProps({ref_key:"form",ref:c,model:e.unref(n)},e.unref(k)),{default:e.withCtx(()=>{var f;return[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((f=l.formSchema)==null?void 0:f.nodes,(m,P)=>(e.openBlock(),e.createBlock(y,{modelValue:e.unref(n)[m.field],"onUpdate:modelValue":_=>e.unref(n)[m.field]=_,model:e.unref(n),key:P,record:m},e.createSlots({_:2},[m.slot?{name:p(m.slot),fn:e.withCtx(_=>[e.renderSlot(t.$slots,m.slot,e.normalizeProps(e.guardReactiveProps(_||{})))]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","model","record"]))),128))]}),_:3},16,["model"]))}}),B=[F],V={install(a){B.forEach(r=>{a.component(r.__name,r)})}};o.KFormBuild=F,o.default=V,o.pluginManager=i,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
