(function(o,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(o=typeof globalThis<"u"?globalThis:o||self,e(o["k-form-design"]={},o.Vue))})(this,function(o,e){"use strict";var S=Object.defineProperty;var w=(o,e,c)=>e in o?S(o,e,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[e]=c;var B=(o,e,c)=>(w(o,typeof e!="symbol"?e+"":e,c),c);class c{constructor(){B(this,"components",{})}addComponent(r,l){this.components[r]=l}getComponents(){return this.components}getComponent(r){return this.components[r]}}const p=new c,C=e.defineComponent({__name:"KFormItem",props:{record:{type:Object,require:!0},model:{type:Object},modelValue:{}},emits:["update:modelValue"],setup(m,{emit:r}){const l=m,u=p.getComponent("FormItem"),{record:n}=l,a=n.componentProps,g=p.getComponents()[n.component];function h(d){r("update:modelValue",d)}return e.onMounted(()=>{a.defaultValue&&h(a.defaultValue)}),(d,t)=>(e.openBlock(),e.createBlock(e.unref(u),e.mergeProps(e.unref(n),{name:e.unref(n).field}),{default:e.withCtx(()=>[e.renderSlot(d.$slots,e.unref(n).slot,{value:l.modelValue,model:l.model,record:e.unref(n)},()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(e.unref(g)),e.mergeProps({style:{width:"100%"},value:l.model[e.unref(n).field],"onUpdate:value":t[0]||(t[0]=i=>l.model[e.unref(n).field]=i)},e.unref(a)),null,16,["value"]))])]),_:3},16,["name"]))}}),k=e.defineComponent({__name:"KFormBuild",props:{formSchema:{type:Object}},setup(m,{expose:r}){const l=m,u=p.getComponent("Form");let n=e.reactive({});const a=e.ref(null),y=e.computed(()=>{var t;return{...(t=l.formSchema)==null?void 0:t.config}});function g(){return new Promise(async(t,i)=>{var f;try{await((f=a.value)==null?void 0:f.validateFields()),t(n)}catch(s){i(s)}})}function h(t){Object.assign(n,t)}function d(t){return t||""}return r({getData:g,setData:h}),(t,i)=>(e.openBlock(),e.createBlock(e.unref(u),e.mergeProps({ref_key:"form",ref:a,model:e.unref(n)},e.unref(y)),{default:e.withCtx(()=>{var f;return[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((f=l.formSchema)==null?void 0:f.nodes,(s,P)=>(e.openBlock(),e.createBlock(C,{modelValue:e.unref(n)[s.field],"onUpdate:modelValue":_=>e.unref(n)[s.field]=_,model:e.unref(n),key:P,record:s},e.createSlots({_:2},[s.slot?{name:d(s.slot),fn:e.withCtx(_=>[e.renderSlot(t.$slots,s.slot,e.normalizeProps(e.guardReactiveProps(_||{})))]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","model","record"]))),128))]}),_:3},16,["model"]))}}),V=[k],F={install(m){V.forEach(r=>{m.component(r.__name,r)})}};o.KFormBuild=k,o.default=F,o.pluginManager=p,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
