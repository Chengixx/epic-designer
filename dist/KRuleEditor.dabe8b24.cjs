"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),g=require("./index.89664b5e.cjs"),f=require("./revoke.800898d2.cjs"),B={class:"rule-item-main bg-white m-t-2 p-2 rounded border border-solid border-gray-200 hover:border-primary transition-all relative"},_={key:0,class:"flex m-t-2 first:m-0"},C={class:"attr-label",title:"\u6821\u9A8C\u65F6\u673A"},V={class:"attr-input"},F=e.createElementVNode("span",{class:"iconfont icon-shanchu1"},null,-1),A=[F],E=e.defineComponent({__name:"KRuleItem",props:{rule:{type:Object,required:!0}},emits:["update:rule","change","delete"],setup(i,{emit:s}){const p=i,m=e.inject("pageManager",{}),n=e.computed(()=>Object.entries(m.funcs.value).filter(([l,a])=>typeof a=="function").map(([l])=>({label:l,value:l}))),c=["string","number","url","array","email"],h=[{label:"change",value:"change"},{label:"blur",value:"blur"}],o=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"},{label:"method",value:"method"},{label:"regexp",value:"regexp"},{label:"integer",value:"integer"},{label:"float",value:"float"},{label:"array",value:"array"},{label:"object",value:"object"},{label:"date",value:"date"},{label:"url",value:"url"},{label:"hex",value:"hex"},{label:"email",value:"email"},{label:"any",value:"any"}],v=[{type:"select",label:"\u6821\u9A8C\u65F6\u673A",model:"trigger",componentProps:{options:h,placeholder:"\u6821\u9A8C\u65F6\u673A",multiple:!0,mode:"multiple"}},{type:"switch",label:"\u81EA\u5B9A\u4E49\u89C4\u5219",model:"isValidator"},{type:"select",label:"\u6821\u9A8C\u51FD\u6570",model:"validator",show(){return Boolean(t.value.isValidator)},componentProps:{options:n.value,placeholder:"\u6821\u9A8C\u51FD\u6570"}},{type:"select",label:"\u7C7B\u578B",model:"type",show(){return!t.value.isValidator},componentProps:{options:o,placeholder:"\u7C7B\u578B"}},{type:"input",label:"\u6B63\u5219\u6821\u9A8C",model:"pattern",show(){return!t.value.isValidator},componentProps:{placeholder:"\u6B63\u5219\u6821\u9A8C"}},{type:"number",label:"\u5B57\u6BB5\u957F\u5EA6",model:"len",show(){var l;return c.includes((l=t.value.type)!=null?l:"")},componentProps:{min:0,placeholder:"\u5B57\u6BB5\u957F\u5EA6"}},{type:"number",label:"\u6700\u5C0F\u957F\u5EA6",model:"min",show(){var l;return c.includes((l=t.value.type)!=null?l:"")},componentProps:{min:0,placeholder:"\u6700\u5C0F\u957F\u5EA6"}},{type:"number",label:"\u6700\u5927\u957F\u5EA6",model:"max",show(){var l;return c.includes((l=t.value.type)!=null?l:"")},componentProps:{min:0,placeholder:"\u6700\u5927\u957F\u5EA6"}},{type:"input",label:"\u6821\u9A8C\u4FE1\u606F",model:"message",componentProps:{placeholder:"\u6821\u9A8C\u4FE1\u606F"}}],t=e.ref({});e.watch(()=>p.rule,l=>{t.value=l},{deep:!0,immediate:!0});function b(){const l=t.value;l.isValidator?(delete l.type,delete l.pattern,delete l.len,delete l.min,delete l.max):delete l.validator,s("update:rule",l),s("change",l)}function r(){s("delete")}return(l,a)=>(e.openBlock(),e.createElementBlock("div",B,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(v,(u,d)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:d},[!u.show||u.show()?(e.openBlock(),e.createElementBlock("div",_,[e.createElementVNode("div",C,e.toDisplayString(u.label),1),e.createElementVNode("div",V,[e.createVNode(e.unref(g._sfc_main$1),{record:u,modelValue:t.value[u.model],"onUpdate:modelValue":y=>t.value[u.model]=y,onChange:b},null,8,["record","modelValue","onUpdate:modelValue"])])])):e.createCommentVNode("",!0)],64))),64)),e.createElementVNode("div",{class:"rule-btn-delete absolute top-0 right-0 transition-all w-6 h-6 cursor-pointer rounded-bl-1 flex-center color-white",onClick:r},A)]))}}),k={class:"rule-item-main bg-white m-t-2 p-2 rounded border border-solid border-gray-200 hover:border-primary transition-all relative"},w={key:0,class:"flex m-t-2 first:m-0"},x={class:"attr-label"},N={class:"flex-1"},q=e.defineComponent({__name:"KRuleEditor",props:{modelValue:{type:Array,default:null}},emits:["update:modelValue"],setup(i,{emit:s}){const p=i,m=g.pluginManager.getComponent("button"),n=e.ref({required:!1,message:"\u5FC5\u586B\u9879",trigger:["change"]}),h=[{type:"switch",label:"\u5FC5\u586B\u9879",model:"required"},{type:"select",label:"\u6821\u9A8C\u65F6\u673A",model:"trigger",show(){return Boolean(n.value.required)},componentProps:{options:[{label:"change",value:"change"},{label:"blur",value:"blur"}],placeholder:"\u6821\u9A8C\u65F6\u673A",multiple:!0,mode:"multiple"}},{type:"input",label:"\u6821\u9A8C\u4FE1\u606F",model:"message",show(){return Boolean(n.value.required)},componentProps:{placeholder:"\u6821\u9A8C\u4FE1\u606F"}}],o=e.ref([]);e.watch(()=>p.modelValue,r=>{if(r){if(!r)return;o.value=[],r.forEach(l=>{typeof l.required<"u"?n.value=l:o.value.push(l)})}},{immediate:!0});function v(){o.value.push({message:"",trigger:["change"]}),t()}function t(){if(n.value.required){s("update:modelValue",f.deepClone([...o.value,n.value]));return}if(o.value.length){s("update:modelValue",f.deepClone(o.value));return}s("update:modelValue",void 0)}function b(r){o.value.splice(r,1),t()}return(r,l)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",k,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(h,(a,u)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:u},[!a.show||a.show()?(e.openBlock(),e.createElementBlock("div",w,[e.createElementVNode("div",x,e.toDisplayString(a.label),1),e.createElementVNode("div",N,[e.createVNode(e.unref(g._sfc_main$1),{record:a,modelValue:n.value[a.model],"onUpdate:modelValue":d=>n.value[a.model]=d,onChange:t},null,8,["record","modelValue","onUpdate:modelValue"])])])):e.createCommentVNode("",!0)],64))),64))]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value,(a,u)=>(e.openBlock(),e.createBlock(E,{rule:o.value[u],"onUpdate:rule":d=>o.value[u]=d,onDelete:d=>b(u),onChange:t,key:u},null,8,["rule","onUpdate:rule","onDelete"]))),128)),e.createVNode(e.unref(m),{class:"m-t-2",onClick:v},{default:e.withCtx(()=>[e.createTextVNode("\u6DFB\u52A0\u89C4\u5219")]),_:1})]))}});exports.default=q;
