"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),_=require("./index.89664b5e.cjs"),b=require("./vuedraggable.umd.8ad24d24.cjs"),a=require("./revoke.800898d2.cjs");require("./_commonjsHelpers.c9801f70.cjs");require("./_vue_commonjs-external.db6f8c6f.cjs");const w=["onClick","onMouseover"],V={class:"action-box"},j={class:"action-item"},D=["onClick"],$=e.createElementVNode("span",{class:"iconfont icon-fuzhi3"},null,-1),M=[$],x=["onClick"],I=e.createElementVNode("span",{class:"iconfont icon-shanchu1"},null,-1),S=[I],q=e.defineComponent({__name:"KEditNodeItem",props:{schemas:{type:Array}},emits:["update:schemas"],setup(f,{emit:c}){const u=f,r=e.inject("designer"),d=e.inject("schemas"),m=e.ref(""),s=e.computed({get(){return u.schemas},set(o){c("update:schemas",o)}});e.watch(s,o=>{var n;o!=null&&o.length&&(m.value=(n=o[0].id)!=null?n:"")},{immediate:!0});function k(o){r.setCheckedNode(s.value[o])}function N(){r.setDisableHover(),a.revoke.push(d.value,"\u62D6\u62FD\u7EC4\u4EF6")}function E(){a.revoke.push(d.value,"\u63D2\u5165\u7EC4\u4EF6")}function y(o,n,t){var h;const i=a.deepClone({...e.toRaw(n),id:a.getUUID()});o.splice(t+1,0,i);const l=i.children?[...i.children]:[];for(;l.length>0;){const p=l.pop();p.id=a.getUUID(),((h=p.children)==null?void 0:h.length)>0&&l.push(...p.children)}r.setCheckedNode(i),a.revoke.push(d.value,"\u590D\u5236\u7EC4\u4EF6")}function B(o,n,t){o=o.filter((i,l)=>t!==l),c("update:schemas",o),t===o.length&&t--,r.setCheckedNode(o[t]),a.revoke.push(d.value,"\u5220\u9664\u7EC4\u4EF6")}return(o,n)=>(e.openBlock(),e.createBlock(e.unref(b.draggable),{modelValue:e.unref(s),"onUpdate:modelValue":n[1]||(n[1]=t=>e.isRef(s)?s.value=t:null),group:m.value==="root"||"edit-draggable","item-key":"id",onStart:n[2]||(n[2]=t=>{k(t.oldIndex),e.unref(r).setDisableHover(!0)}),onEnd:n[3]||(n[3]=t=>N()),onAdd:n[4]||(n[4]=t=>{k(t.newIndex),E()}),ghostClass:"moveing","component-data":{name:"draggable-range"}},{item:e.withCtx(({element:t,index:i})=>{var l,h,p,g;return[e.createElementVNode("div",{class:e.normalizeClass(["item",{checked:((l=e.unref(r).state.checkedNode)==null?void 0:l.id)===t.id,hover:((h=e.unref(r).state.hoverNode)==null?void 0:h.id)===t.id,"root-node":t.id==="root"}]),onClick:e.withModifiers(v=>e.unref(r).setCheckedNode(t),["stop"]),onMouseover:e.withModifiers(v=>e.unref(r).setHoverNode(t),["stop"]),onMouseout:n[0]||(n[0]=e.withModifiers(v=>e.unref(r).setHoverNode(null),["stop"]))},[e.withDirectives(e.createElementVNode("div",V,[e.createElementVNode("div",j,e.toDisplayString((p=e.unref(_.pluginManager).getComponentConfingByType(t.type))==null?void 0:p.defaultSchema.label),1),m.value!=="root"?(e.openBlock(),e.createElementBlock("div",{key:0,title:"\u590D\u5236",class:"action-item",onClick:e.withModifiers(v=>y(e.unref(s),t,i),["stop"])},M,8,D)):e.createCommentVNode("",!0),m.value!=="root"?(e.openBlock(),e.createElementBlock("div",{key:1,title:"\u5220\u9664",class:"action-item",onClick:e.withModifiers(v=>B(e.unref(s),t,i),["stop"])},S,8,x)):e.createCommentVNode("",!0)],512),[[e.vShow,((g=e.unref(r).state.checkedNode)==null?void 0:g.id)===t.id]]),e.createVNode(C,{element:t},null,8,["element"])],42,w)]}),_:1},8,["modelValue","group"]))}}),C=e.defineComponent({__name:"KNodeItem",props:{element:{type:Object,required:!0}},setup(f){const c=f,u=c.element;return e.onBeforeUpdate(()=>{console.log("\u66F4\u65B0\u4E8622")}),(r,d)=>{const m=e.resolveComponent("KNodeItem",!0);return["row","tabs"].includes(c.element.type)?(e.openBlock(),e.createBlock(e.unref(_._sfc_main$1),{key:0,record:c.element},{"edit-node":e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u).children,s=>(e.openBlock(),e.createBlock(m,{key:s.id,element:s},null,8,["element"]))),128))]),_:1},8,["record"])):(e.openBlock(),e.createBlock(e.unref(_._sfc_main$1),{key:1,record:c.element},{"edit-node":e.withCtx(()=>[e.createVNode(q,{schemas:e.unref(u).children,"onUpdate:schemas":d[0]||(d[0]=s=>e.unref(u).children=s)},null,8,["schemas"])]),_:1},8,["record"]))}}}),F={class:"k-edit-container"},U={class:"k-edit-range rounded-md"},K=e.defineComponent({__name:"KEditContainer",setup(f){const c=e.inject("schemas"),u=e.computed(()=>c.value[0]);return(r,d)=>(e.openBlock(),e.createElementBlock("section",F,[e.createElementVNode("div",U,[e.createVNode(C,{element:e.unref(u)},null,8,["element"])])]))}});exports.default=K;
