"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),c=require("./index-a6f7fd90.cjs"),V=require("./icon.vue_vue_type_script_setup_true_lang-5a70b817.cjs"),f=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"},{label:"method",value:"method"},{label:"regexp",value:"regexp"},{label:"integer",value:"integer"},{label:"float",value:"float"},{label:"array",value:"array"},{label:"object",value:"object"},{label:"date",value:"date"},{label:"url",value:"url"},{label:"hex",value:"hex"},{label:"email",value:"email"},{label:"any",value:"any"}],_=[{label:"change",value:"change"},{label:"blur",value:"blur"}],y=["string","number","url","array","email"],k={class:"rule-item-main bg-white m-t-2 p-2 rounded border border-solid border-gray-200 hover:border-primary transition-all relative"},B={key:0,class:"flex m-t-2 first:m-0"},w={class:"attr-label",title:"校验时机"},E={class:"attr-input"},x=e.defineComponent({__name:"ERuleItem",props:{rule:{}},emits:["change","delete","update:rule"],setup(m,{emit:v}){const s=v,h=m,l=e.computed({get(){return h.rule},set(t){s("update:rule",t)}}),b=e.inject("pageManager",{}),o=e.computed(()=>Object.entries(b.funcs.value).filter(([t,a])=>typeof a=="function").map(([t])=>({label:t,value:t}))),i=[{type:"select",label:"校验时机",model:"trigger",componentProps:{options:_,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"switch",label:"自定义规则",model:"isValidator"},{type:"select",label:"校验函数",model:"validator",show(){return!!l.value.isValidator},componentProps:{options:o.value,placeholder:"校验函数"}},{type:"select",label:"类型",model:"type",show(){return!l.value.isValidator},componentProps:{options:f,placeholder:"类型"}},{type:"input",label:"正则校验",model:"pattern",show(){return!l.value.isValidator},componentProps:{placeholder:"正则校验"}},{type:"number",label:"字段长度",model:"len",show(){return y.includes(l.value.type??"")},componentProps:{min:0,placeholder:"字段长度"}},{type:"number",label:"最小长度",model:"min",show(){return y.includes(l.value.type??"")},componentProps:{min:0,placeholder:"最小长度"}},{type:"number",label:"最大长度",model:"max",show(){return y.includes(l.value.type??"")},componentProps:{min:0,placeholder:"最大长度"}},{type:"input",label:"校验信息",model:"message",componentProps:{placeholder:"校验信息"}}];function g(){const t=l.value;t.isValidator?(delete t.type,delete t.pattern,delete t.len,delete t.min,delete t.max):delete t.validator,s("change",t)}function d(){s("delete")}return(t,a)=>(e.openBlock(),e.createElementBlock("div",k,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(i,(r,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[!r.show||r.show()?(e.openBlock(),e.createElementBlock("div",B,[e.createElementVNode("div",w,e.toDisplayString(r.label),1),e.createElementVNode("div",E,[e.createVNode(e.unref(c._sfc_main$1),{modelValue:l.value[r.model],"onUpdate:modelValue":u=>l.value[r.model]=u,componentSchema:{...r,noFormItem:!0},onChange:g},null,8,["modelValue","onUpdate:modelValue","componentSchema"])])])):e.createCommentVNode("",!0)],64))),64)),e.createElementVNode("div",{class:"rule-btn-delete absolute top-0 right-0 transition-all w-24px h-24px cursor-pointer rounded-bl-2 flex justify-center items-center color-white",onClick:d},[e.createVNode(e.unref(V._sfc_main),{name:"icon-shanchu1"})])]))}}),C={class:"rule-item-main bg-white m-t-2 p-2 rounded border border-solid border-gray-200 hover:border-primary transition-all relative"},N={key:0,class:"flex m-t-2 first:m-0"},q={class:"attr-label"},P={class:"flex-1"},U=e.defineComponent({__name:"index",props:{modelValue:{type:Array,default:void 0}},emits:["update:modelValue"],setup(m,{emit:v}){const s=c.pluginManager.getComponent("button"),h=m,l=e.ref({required:!1,message:"必填项",type:"string",trigger:["change"]}),b=[{type:"switch",label:"必填项",model:"required"},{type:"select",label:"校验时机",model:"trigger",show(){return!!l.value.required},componentProps:{options:_,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"select",label:"类型",model:"type",show(){return!!l.value.required},componentProps:{options:f,placeholder:"类型"}},{type:"input",label:"校验信息",model:"message",show(){return!!l.value.required},componentProps:{placeholder:"校验信息"}}],o=e.ref([]),i=v;e.watch(()=>h.modelValue,a=>{if(a){if(!a)return;o.value=[],a.forEach(r=>{typeof r.required<"u"?l.value=r:o.value.push(r)})}},{immediate:!0});function g(){o.value.push({message:"",trigger:["change"]}),d()}function d(){if(l.value.required){i("update:modelValue",c.deepClone([...o.value,l.value]));return}if(o.value.length){i("update:modelValue",c.deepClone(o.value));return}i("update:modelValue",void 0)}function t(a){o.value.splice(a,1),d()}return(a,r)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",C,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(b,(n,u)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:u},[!n.show||n.show()?(e.openBlock(),e.createElementBlock("div",N,[e.createElementVNode("div",q,e.toDisplayString(n.label),1),e.createElementVNode("div",P,[e.createVNode(e.unref(c._sfc_main$1),{modelValue:l.value[n.model],"onUpdate:modelValue":p=>l.value[n.model]=p,componentSchema:{...n,noFormItem:!0},onChange:d},null,8,["modelValue","onUpdate:modelValue","componentSchema"])])])):e.createCommentVNode("",!0)],64))),64))]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value,(n,u)=>(e.openBlock(),e.createBlock(x,{key:u,rule:o.value[u],"onUpdate:rule":p=>o.value[u]=p,onDelete:p=>t(u),onChange:d},null,8,["rule","onUpdate:rule","onDelete"]))),128)),e.createVNode(e.unref(s),{class:"m-t-2",onClick:g},{default:e.withCtx(()=>[e.createTextVNode(" 添加规则 ")]),_:1})]))}});exports.default=U;
