"use strict";const e=require("vue"),_=require("./icon.vue_vue_type_script_setup_true_lang-5a70b817.cjs"),C=require("./index-a6f7fd90.cjs"),b=require("./vuedraggable.umd-50dcd280.cjs"),k=e.defineComponent({name:"ETreeNodeItem",__name:"treeNodeItem",props:{schema:{}},setup(g){const n=g,u=e.inject("slots",{}),r=e.inject("expandedKeys"),d=e.inject("treeProps"),f=e.inject("selectedKeys"),c=e.inject("handleSelect"),m=e.computed(()=>r.value.includes(n.schema.id??"")),h=e.defineComponent({setup(){return()=>{var s;return e.h("span",{class:{text:!0,hover:d.hoverKey===n.schema.id,checked:f.value.includes(n.schema.id)},onClick:()=>c(n.schema.id,n.schema)},((s=u["tree-node"])==null?void 0:s.call(u,n))??e.h("span",{class:"text-padding"},{default:()=>{var a;return[n.schema.label??((a=C.pluginManager.getComponentConfingByType(n.schema.type))==null?void 0:a.defaultSchema.label),e.h("span",{class:"epic-node-type-text"},n.schema.type)]}}))}}});function l(){const s=n.schema.id;if(!s)return!1;r.value.includes(s)?r.value=r.value.filter(a=>a!==s):r.value.push(s)}function i(){var a;const s=n.schema.id;if(!s||!((a=n.schema.children)!=null&&a.length))return!1;r.value.push(s)}return i(),(s,a)=>{var t,o,p;return e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["epic-tree-node",{expanded:(t=n.schema.children)==null?void 0:t.length,"level-1":n.schema.type==="page"}])},[e.createElementVNode("a",null,[(o=n.schema.children)!=null&&o.length&&n.schema.type!=="page"?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(["icon-expanded",{expanded:m.value}]),onClick:l},[e.createVNode(e.unref(_._sfc_main),{name:"icon-youjiantou"})],2)):e.createCommentVNode("",!0),e.createVNode(e.unref(h))]),(p=n.schema.children)!=null&&p.length?(e.openBlock(),e.createBlock(B,{key:0,class:e.normalizeClass(["epic-tree-sublist",{expanded:m.value}]),schemas:n.schema.children,"onUpdate:schemas":a[0]||(a[0]=v=>n.schema.children=v),parentSchema:n.schema},null,8,["class","schemas","parentSchema"])):e.createCommentVNode("",!0)],2)}}}),N={key:1},B=e.defineComponent({name:"ETreeNodes",__name:"treeNodes",props:{schemas:{},parentSchema:{}},emits:["update:schemas"],setup(g,{emit:n}){const u=e.inject("designer"),r=e.inject("treeProps"),d=g,f=n,c=e.computed({get(){return d.schemas},set(l){f("update:schemas",l)}});function m(l){u.setDisableHover(!0),u.setCheckedNode(c.value[l])}function h(l){return l.type==="page"||l.immovable?"unmover-item":"draggable-item"}return(l,i)=>{var s,a;return(s=d.parentSchema)!=null&&s.childImmovable?(e.openBlock(),e.createElementBlock("ul",N,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c.value,t=>(e.openBlock(),e.createBlock(k,{key:t.id,schema:t},null,8,["schema"]))),128))])):(e.openBlock(),e.createBlock(e.unref(b.draggable),e.mergeProps({key:0,modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=t=>c.value=t),"item-key":"id","component-data":{},class:"draggable-range"},{animation:200,tag:"ul",group:"tree-draggable",ghostClass:"moveing",draggable:".draggable-item",disabled:!e.unref(r).draggable||((a=c.value[0])==null?void 0:a.type)==="page"},{onStart:i[1]||(i[1]=t=>m(t.oldIndex))}),{item:e.withCtx(({element:t,index:o})=>[(e.openBlock(),e.createBlock(k,{class:e.normalizeClass(h(t)),key:t.id,schema:t},null,8,["class","schema"]))]),_:1},16,["modelValue"]))}}}),V={class:"epic-tree h-full flex flex-col"},S={class:"search-box px-10px py-6px"},E={class:"epic-tree-main flex-1 overflow-auto h-0"},K={class:"text-center pt-42px text-gray-400"},j=e.defineComponent({name:"ETree",__name:"tree",props:{options:{type:Array,default:()=>[]},hoverKey:{type:String,default:""},selectedKeys:{type:Array,default:()=>[]},draggable:{type:Boolean,default:!1}},emits:["update:selectedKeys","node-click"],setup(g,{emit:n}){const u=e.useSlots();e.provide("slots",u);const r=C.pluginManager.getComponent("input"),d=e.ref(""),f=e.ref([]),c=g,m=n,h=e.computed({get(){return c.selectedKeys},set(a){m("update:selectedKeys",a)}}),l=e.computed({get(){return i(c.options,d.value)},set(a){console.log(a)}});function i(a,t){const o=[];return a.forEach(p=>{var v;if((v=p.label)!=null&&v.includes(t))o.push(p);else if(p.children){const y=i(p.children,t);if(y.length>0){const x={...p};x.children=y,o.push(x)}}}),o}function s(a,t){h.value=[a],m("node-click",{id:a,componentSchema:t})}return e.provide("expandedKeys",f),e.provide("selectedKeys",h),e.provide("treeProps",c),e.provide("handleSelect",s),e.provide("handleSelect",s),(a,t)=>(e.openBlock(),e.createElementBlock("div",V,[e.createElementVNode("div",S,[e.createVNode(e.unref(r),{placeholder:"搜索节点",clearable:"",allowClear:"",modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=o=>d.value=o),value:d.value,"onUpdate:value":t[1]||(t[1]=o=>d.value=o)},{prefix:e.withCtx(()=>[e.createVNode(e.unref(_._sfc_main),{name:"icon-chaxun"})]),_:1},8,["modelValue","value"])]),e.createElementVNode("div",E,[e.createElementVNode("ul",null,[e.createVNode(B,{schemas:l.value,"onUpdate:schemas":t[2]||(t[2]=o=>l.value=o)},null,8,["schemas"])]),e.withDirectives(e.createElementVNode("div",K,"没有查询到的数据",512),[[e.vShow,!l.value.length]])])]))}});exports._sfc_main=j;
