import{g as V,k as j,p as h,r as w,h as _,o as u,c as S,d as b,e as k,s as P,u as v,E as A,F as D,l as p,N as G,Y as M,x as K,n as N,m as z,R as E,G as I}from"../app.db33cb3d.js";import{m as T}from"./icon.vue_vue_type_script_setup_true_lang-eb196e28.b7e231b8.js";import{M as F}from"./index.4abc0d1b.js";import{R as H}from"./vuedraggable.umd-6a5b6da9.1ae79871.js";const U=V({name:"ETreeNodeItem",__name:"treeNodeItem",props:{schema:{}},setup(g){const l=g,o=p("slots",{}),c=p("expandedKeys"),y=p("treeProps"),t=p("selectedKeys"),f=p("handleSelect"),i=_(()=>{var a;return c.value.includes((a=l.schema.id)!=null?a:"")}),n=V({setup(){return()=>{var e;var a;return E("span",{class:{text:!0,hover:y.hoverKey===l.schema.id,checked:t.value.includes(l.schema.id)},onClick:()=>f(l.schema.id,l.schema)},(e=(a=o["tree-node"])==null?void 0:a.call(o,l))!=null?e:E("span",{class:"text-padding"},{default:()=>{var r;var s;return[(r=l.schema.label)!=null?r:(s=F.getComponentConfingByType(l.schema.type))==null?void 0:s.defaultSchema.label,E("span",{class:"epic-node-type-text"},l.schema.type)]}}))}}});function d(){const a=l.schema.id;if(!a)return!1;c.value.includes(a)?c.value=c.value.filter(e=>e!==a):c.value.push(a)}function m(){var a;const e=l.schema.id;if(!e||!((a=l.schema.children)!=null&&a.length))return!1;c.value.push(e)}return m(),(a,e)=>{var s,r,x;return u(),S("li",{class:N(["epic-tree-node",{expanded:(s=l.schema.children)==null?void 0:s.length,"level-1":l.schema.type==="page"}])},[b("a",null,[(r=l.schema.children)!=null&&r.length&&l.schema.type!=="page"?(u(),S("span",{key:0,class:N(["icon-expanded",{expanded:i.value}]),onClick:d},[k(v(T),{name:"icon-youjiantou"})],2)):I("",!0),k(v(n))]),(x=l.schema.children)!=null&&x.length?(u(),K(R,{key:0,class:N(["epic-tree-sublist",{expanded:i.value}]),schemas:l.schema.children,"onUpdate:schemas":e[0]||(e[0]=C=>l.schema.children=C),parentSchema:l.schema},null,8,["class","schemas","parentSchema"])):I("",!0)],2)}}}),J={key:1},R=V({name:"ETreeNodes",__name:"treeNodes",props:{schemas:{},parentSchema:{}},emits:["update:schemas"],setup(g,{emit:l}){const o=g,c=p("designer"),y=p("treeProps"),t=_({get(){return o.schemas},set(n){l("update:schemas",n)}});function f(n){c.setDisableHover(!0),c.setCheckedNode(t.value[n])}function i(n){return n.type==="page"||n.immovable?"unmover-item":"draggable-item"}return(n,d)=>{var m,a;return(m=o.parentSchema)!=null&&m.childImmovable?(u(),S("ul",J,[(u(!0),S(G,null,M(t.value,e=>(u(),K(U,{key:e.id,schema:e},null,8,["schema"]))),128))])):(u(),K(v(H),z({key:0,modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=e=>t.value=e),"item-key":"id","component-data":{},class:"draggable-range"},{animation:200,tag:"ul",group:"tree-draggable",ghostClass:"moveing",draggable:".draggable-item",disabled:!v(y).draggable||((a=t.value[0])==null?void 0:a.type)==="page"},{onStart:d[1]||(d[1]=e=>f(e.oldIndex))}),{item:P(({element:e,index:s})=>[(u(),K(U,{class:N(i(e)),key:e.id,schema:e},null,8,["class","schema"]))]),_:1},16,["modelValue"]))}}}),L={class:"epic-tree h-full flex flex-col"},O={class:"search-box px-10px py-6px"},Q={class:"epic-tree-main flex-1 overflow-auto h-0"},Y={class:"text-center pt-42px text-gray-400"},X=V({name:"ETree",__name:"tree",props:{options:{type:Array,default:()=>[]},hoverKey:{type:String,default:""},selectedKeys:{type:Array,default:()=>[]},draggable:{type:Boolean,default:!1}},emits:["update:selectedKeys","node-click"],setup(g,{emit:l}){const o=g,c=j();h("slots",c);const y=F.getComponent("input"),t=w(""),f=w([]),i=_({get(){return o.selectedKeys},set(a){l("update:selectedKeys",a)}}),n=_({get(){return d(o.options,t.value)},set(a){console.log(a)}});function d(a,e){const s=[];return a.forEach(r=>{var x;if((x=r.label)!=null&&x.includes(e))s.push(r);else if(r.children){const C=d(r.children,e);if(C.length>0){const B={...r};B.children=C,s.push(B)}}}),s}function m(a,e){i.value=[a],l("node-click",{id:a,componentSchema:e})}return h("expandedKeys",f),h("selectedKeys",i),h("treeProps",o),h("handleSelect",m),h("handleSelect",m),(a,e)=>(u(),S("div",L,[b("div",O,[k(v(y),{placeholder:"\u641C\u7D22\u8282\u70B9",clearable:"",allowClear:"",modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=s=>t.value=s),value:t.value,"onUpdate:value":e[1]||(e[1]=s=>t.value=s)},{prefix:P(()=>[k(v(T),{name:"icon-chaxun"})]),_:1},8,["modelValue","value"])]),b("div",Q,[b("ul",null,[k(R,{schemas:n.value,"onUpdate:schemas":e[2]||(e[2]=s=>n.value=s)},null,8,["schemas"])]),A(b("div",Y,"\u6CA1\u6709\u67E5\u8BE2\u5230\u7684\u6570\u636E",512),[[D,!n.value.length]])])]))}});export{X as Z};
