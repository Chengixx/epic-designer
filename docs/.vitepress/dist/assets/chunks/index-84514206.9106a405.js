import{e as K,am as V,r as I,a1 as ue,I as fe,f as g,w as W,O as de,l as me,o as z,x as j,d as o,s as p,b as u,n as c,u as a,v as G,B as ve,G as O,c as Y,N as H,Q as pe,Y as be,E as ke,F as ge,g as we,z as he,ag as xe}from"../app.c22c6c8c.js";import{h as ye,j as _e,aX as Ce,a0 as U,v as Ie,D as w,S as ze,ai as Oe,_ as Ne,bK as Te,aZ as Re,bL as Le,bM as Ae,U as Xe,bN as Ye,bO as Be,ae as R,P as Ee,bD as $e,a8 as C,bG as Fe}from"./index.0d7c8eb8.js";import{K as Se,Y as De}from"./index-bbbf8f32.66a4d34d.js";import{q as Me}from"./debounce-6534728b.33e5c19b.js";var Pe="Expected a function";function B(x,N,b){var t=!0,f=!0;if(typeof x!="function")throw new TypeError(Pe);return $e(b)&&(t="leading"in b?!!b.leading:t,f="trailing"in b?!!b.trailing:f),Me(x,N,{leading:t,maxWait:N,trailing:f})}const Qe=ye({urlList:{type:_e(Array),default:()=>Ce([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Ve={close:()=>!0,switch:x=>U(x)},We=["src"],je=K({name:"ElImageViewer"}),Ge=K({...je,props:Qe,emits:Ve,setup(x,{expose:N,emit:b}){const t=x,f={CONTAIN:{name:"contain",icon:V(Ye)},ORIGINAL:{name:"original",icon:V(Be)}},{t:Z}=Se(),l=Ie("image-viewer"),{nextZIndex:q}=De(),L=I(),E=I([]),$=ue(),y=I(!0),k=I(t.initialIndex),T=fe(f.CONTAIN),i=I({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),J=g(()=>{const{urlList:e}=t;return e.length<=1}),F=g(()=>k.value===0),S=g(()=>k.value===t.urlList.length-1),ee=g(()=>t.urlList[k.value]),ae=g(()=>[l.e("btn"),l.e("prev"),l.is("disabled",!t.infinite&&F.value)]),ne=g(()=>[l.e("btn"),l.e("next"),l.is("disabled",!t.infinite&&S.value)]),se=g(()=>{const{scale:e,deg:n,offsetX:s,offsetY:r,enableTransition:d}=i.value;let m=s/e,v=r/e;switch(n%360){case 90:case-270:[m,v]=[v,-m];break;case 180:case-180:[m,v]=[-m,-v];break;case 270:case-90:[m,v]=[-v,m];break}const _={transform:`scale(${e}) rotate(${n}deg) translate(${m}px, ${v}px)`,transition:d?"transform .3s":""};return T.value.name===f.CONTAIN.name&&(_.maxWidth=_.maxHeight="100%"),_}),te=g(()=>U(t.zIndex)?t.zIndex:q());function A(){oe(),b("close")}function le(){const e=B(s=>{switch(s.code){case C.esc:t.closeOnPressEscape&&A();break;case C.space:M();break;case C.left:P();break;case C.up:h("zoomIn");break;case C.right:Q();break;case C.down:h("zoomOut");break}}),n=B(s=>{const r=s.deltaY||s.deltaX;h(r<0?"zoomIn":"zoomOut",{zoomRate:t.zoomRate,enableTransition:!1})});$.run(()=>{R(document,"keydown",e),R(document,"wheel",n)})}function oe(){$.stop()}function ie(){y.value=!1}function re(e){y.value=!1,e.target.alt=Z("el.image.error")}function ce(e){if(y.value||e.button!==0||!L.value)return;i.value.enableTransition=!1;const{offsetX:n,offsetY:s}=i.value,r=e.pageX,d=e.pageY,m=B(_=>{i.value={...i.value,offsetX:n+_.pageX-r,offsetY:s+_.pageY-d}}),v=R(document,"mousemove",m);R(document,"mouseup",()=>{v()}),e.preventDefault()}function D(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function M(){if(y.value)return;const e=Fe(f),n=Object.values(f),s=T.value.name,r=(n.findIndex(d=>d.name===s)+1)%e.length;T.value=f[e[r]],D()}function X(e){const n=t.urlList.length;k.value=(e+n)%n}function P(){F.value&&!t.infinite||X(k.value-1)}function Q(){S.value&&!t.infinite||X(k.value+1)}function h(e,n={}){if(y.value)return;const{zoomRate:s,rotateDeg:r,enableTransition:d}={zoomRate:t.zoomRate,rotateDeg:90,enableTransition:!0,...n};switch(e){case"zoomOut":i.value.scale>.2&&(i.value.scale=Number.parseFloat((i.value.scale/s).toFixed(3)));break;case"zoomIn":i.value.scale<7&&(i.value.scale=Number.parseFloat((i.value.scale*s).toFixed(3)));break;case"clockwise":i.value.deg+=r;break;case"anticlockwise":i.value.deg-=r;break}i.value.enableTransition=d}return W(ee,()=>{de(()=>{const e=E.value[0];e!=null&&e.complete||(y.value=!0)})}),W(k,e=>{D(),b("switch",e)}),me(()=>{var e,n;le(),(n=(e=L.value)==null?void 0:e.focus)==null||n.call(e)}),N({setActiveItem:X}),(e,n)=>(z(),j(xe,{to:"body",disabled:!e.teleported},[o(he,{name:"viewer-fade",appear:""},{default:p(()=>[u("div",{ref_key:"wrapper",ref:L,tabindex:-1,class:c(a(l).e("wrapper")),style:G({zIndex:a(te)})},[u("div",{class:c(a(l).e("mask")),onClick:n[0]||(n[0]=ve(s=>e.hideOnClickModal&&A(),["self"]))},null,2),O(" CLOSE "),u("span",{class:c([a(l).e("btn"),a(l).e("close")]),onClick:A},[o(a(w),null,{default:p(()=>[o(a(ze))]),_:1})],2),O(" ARROW "),a(J)?O("v-if",!0):(z(),Y(H,{key:0},[u("span",{class:c(a(ae)),onClick:P},[o(a(w),null,{default:p(()=>[o(a(Oe))]),_:1})],2),u("span",{class:c(a(ne)),onClick:Q},[o(a(w),null,{default:p(()=>[o(a(Ne))]),_:1})],2)],64)),O(" ACTIONS "),u("div",{class:c([a(l).e("btn"),a(l).e("actions")])},[u("div",{class:c(a(l).e("actions__inner"))},[o(a(w),{onClick:n[1]||(n[1]=s=>h("zoomOut"))},{default:p(()=>[o(a(Te))]),_:1}),o(a(w),{onClick:n[2]||(n[2]=s=>h("zoomIn"))},{default:p(()=>[o(a(Re))]),_:1}),u("i",{class:c(a(l).e("actions__divider"))},null,2),o(a(w),{onClick:M},{default:p(()=>[(z(),j(pe(a(T).icon)))]),_:1}),u("i",{class:c(a(l).e("actions__divider"))},null,2),o(a(w),{onClick:n[3]||(n[3]=s=>h("anticlockwise"))},{default:p(()=>[o(a(Le))]),_:1}),o(a(w),{onClick:n[4]||(n[4]=s=>h("clockwise"))},{default:p(()=>[o(a(Ae))]),_:1})],2)],2),O(" CANVAS "),u("div",{class:c(a(l).e("canvas"))},[(z(!0),Y(H,null,be(e.urlList,(s,r)=>ke((z(),Y("img",{ref_for:!0,ref:d=>E.value[r]=d,key:s,src:s,style:G(a(se)),class:c(a(l).e("img")),onLoad:ie,onError:re,onMousedown:ce},null,46,We)),[[ge,r===k.value]])),128))],2),we(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var He=Ee(Ge,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const Je=Xe(He);export{Ve as H,Qe as P,Je as Q};
