import{i as U,aD as G,r as h,J as fe,s as me,m as _,w as W,H as ve,b as ge,o as N,t as j,e as r,v as g,d as v,G as d,u as a,O as K,V as pe,C as z,c as A,F as Z,x as be,E as ke,P as we,Q as _e,B as Ie,af as xe,ao as Ce,an as L}from"../app.b200646e.js";import{i as he,C as ye,H as J,ak as Ee,I as Q,bB as Ne,bC as ze,L as Oe,O as k,ae as Te,aa as Le,ab as Re,bD as Se,bu as Ve,bE as Ae,bF as Xe,_ as $e,E as y,F as Be,G as Fe}from"./index-bff0902e.b584476c.js";import{u as Ye,b as De}from"./index.c4658a99.js";import{d as Me}from"./debounce.e446b4c7.js";var Pe="Expected a function";function X(p,O,f){var I=!0,n=!0;if(typeof p!="function")throw new TypeError(Pe);return he(f)&&(I="leading"in f?!!f.leading:I,n="trailing"in f?!!f.trailing:n),Me(p,O,{leading:I,maxWait:O,trailing:n})}const He=ye({urlList:{type:J(Array),default:()=>Ee([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:J(String)}}),Ge={close:()=>!0,switch:p=>Q(p),rotate:p=>Q(p)},We=["src","crossorigin"],je=U({name:"ElImageViewer"}),Ke=U({...je,props:He,emits:Ge,setup(p,{expose:O,emit:f}){var I;const n=p,E={CONTAIN:{name:"contain",icon:G(Ne)},ORIGINAL:{name:"original",icon:G(ze)}},{t:q}=Ye(),o=Oe("image-viewer"),{nextZIndex:ee}=De(),R=h(),$=h([]),B=fe(),x=h(!0),b=h(n.initialIndex),T=me(E.CONTAIN),l=h({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ae=h((I=n.zIndex)!=null?I:ee()),te=_(()=>{const{urlList:e}=n;return e.length<=1}),F=_(()=>b.value===0),Y=_(()=>b.value===n.urlList.length-1),se=_(()=>n.urlList[b.value]),ne=_(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!n.infinite&&F.value)]),oe=_(()=>[o.e("btn"),o.e("next"),o.is("disabled",!n.infinite&&Y.value)]),le=_(()=>{const{scale:e,deg:t,offsetX:s,offsetY:u,enableTransition:m}=l.value;let i=s/e,c=u/e;switch(t%360){case 90:case-270:[i,c]=[c,-i];break;case 180:case-180:[i,c]=[-i,-c];break;case 270:case-90:[i,c]=[-c,i];break}const C={transform:`scale(${e}) rotate(${t}deg) translate(${i}px, ${c}px)`,transition:m?"transform .3s":""};return T.value.name===E.CONTAIN.name&&(C.maxWidth=C.maxHeight="100%"),C});function S(){ie(),f("close")}function re(){const e=X(s=>{switch(s.code){case y.esc:n.closeOnPressEscape&&S();break;case y.space:M();break;case y.left:P();break;case y.up:w("zoomIn");break;case y.right:H();break;case y.down:w("zoomOut");break}}),t=X(s=>{const u=s.deltaY||s.deltaX;w(u<0?"zoomIn":"zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});B.run(()=>{L(document,"keydown",e),L(document,"wheel",t)})}function ie(){B.stop()}function ue(){x.value=!1}function ce(e){x.value=!1,e.target.alt=q("el.image.error")}function de(e){if(x.value||e.button!==0||!R.value)return;l.value.enableTransition=!1;const{offsetX:t,offsetY:s}=l.value,u=e.pageX,m=e.pageY,i=X(C=>{l.value={...l.value,offsetX:t+C.pageX-u,offsetY:s+C.pageY-m}}),c=L(document,"mousemove",i);L(document,"mouseup",()=>{c()}),e.preventDefault()}function D(){l.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function M(){if(x.value)return;const e=Be(E),t=Object.values(E),s=T.value.name,m=(t.findIndex(i=>i.name===s)+1)%e.length;T.value=E[e[m]],D()}function V(e){const t=n.urlList.length;b.value=(e+t)%t}function P(){F.value&&!n.infinite||V(b.value-1)}function H(){Y.value&&!n.infinite||V(b.value+1)}function w(e,t={}){if(x.value)return;const{minScale:s,maxScale:u}=n,{zoomRate:m,rotateDeg:i,enableTransition:c}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...t};switch(e){case"zoomOut":l.value.scale>s&&(l.value.scale=Number.parseFloat((l.value.scale/m).toFixed(3)));break;case"zoomIn":l.value.scale<u&&(l.value.scale=Number.parseFloat((l.value.scale*m).toFixed(3)));break;case"clockwise":l.value.deg+=i,f("rotate",l.value.deg);break;case"anticlockwise":l.value.deg-=i,f("rotate",l.value.deg);break}l.value.enableTransition=c}return W(se,()=>{ve(()=>{const e=$.value[0];e!=null&&e.complete||(x.value=!0)})}),W(b,e=>{D(),f("switch",e)}),ge(()=>{var e,t;re(),(t=(e=R.value)==null?void 0:e.focus)==null||t.call(e)}),O({setActiveItem:V}),(e,t)=>(N(),j(Ce,{to:"body",disabled:!e.teleported},[r(xe,{name:"viewer-fade",appear:""},{default:g(()=>[v("div",{ref_key:"wrapper",ref:R,tabindex:-1,class:d(a(o).e("wrapper")),style:K({zIndex:ae.value})},[v("div",{class:d(a(o).e("mask")),onClick:t[0]||(t[0]=pe(s=>e.hideOnClickModal&&S(),["self"]))},null,2),z(" CLOSE "),v("span",{class:d([a(o).e("btn"),a(o).e("close")]),onClick:S},[r(a(k),null,{default:g(()=>[r(a(Te))]),_:1})],2),z(" ARROW "),a(te)?z("v-if",!0):(N(),A(Z,{key:0},[v("span",{class:d(a(ne)),onClick:P},[r(a(k),null,{default:g(()=>[r(a(Le))]),_:1})],2),v("span",{class:d(a(oe)),onClick:H},[r(a(k),null,{default:g(()=>[r(a(Re))]),_:1})],2)],64)),z(" ACTIONS "),v("div",{class:d([a(o).e("btn"),a(o).e("actions")])},[v("div",{class:d(a(o).e("actions__inner"))},[r(a(k),{onClick:t[1]||(t[1]=s=>w("zoomOut"))},{default:g(()=>[r(a(Se))]),_:1}),r(a(k),{onClick:t[2]||(t[2]=s=>w("zoomIn"))},{default:g(()=>[r(a(Ve))]),_:1}),v("i",{class:d(a(o).e("actions__divider"))},null,2),r(a(k),{onClick:M},{default:g(()=>[(N(),j(be(a(T).icon)))]),_:1}),v("i",{class:d(a(o).e("actions__divider"))},null,2),r(a(k),{onClick:t[3]||(t[3]=s=>w("anticlockwise"))},{default:g(()=>[r(a(Ae))]),_:1}),r(a(k),{onClick:t[4]||(t[4]=s=>w("clockwise"))},{default:g(()=>[r(a(Xe))]),_:1})],2)],2),z(" CANVAS "),v("div",{class:d(a(o).e("canvas"))},[(N(!0),A(Z,null,ke(e.urlList,(s,u)=>we((N(),A("img",{ref_for:!0,ref:m=>$.value[u]=m,key:s,src:s,style:K(a(le)),class:d(a(o).e("img")),crossorigin:e.crossorigin,onLoad:ue,onError:ce,onMousedown:de},null,46,We)),[[_e,u===b.value]])),128))],2),Ie(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var Ze=$e(Ke,[["__file","image-viewer.vue"]]);const ea=Fe(Ze);export{ea as E,He as a,Ge as i,X as t};
