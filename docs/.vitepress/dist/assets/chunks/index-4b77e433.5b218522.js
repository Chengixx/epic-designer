import{e as K,am as W,r as O,a1 as ue,H as fe,f as w,w as H,N as de,k as me,o as _,v as Q,d as l,q as p,b as u,n as c,u as a,s as Z,A as ve,F as y,c as E,M as q,Q as pe,Y as be,D as ke,E as we,g as ge,y as xe,ag as he}from"../app.27d58f12.js";import{i as Ce,d as ze,aX as Ne,a0 as j,n as Oe,m as g,W as _e,ai as ye,w as Ie,bK as Te,aZ as Ae,bL as Le,bM as Re,Z as Ye,bN as Ee,bO as Xe,ae as A,p as Be,bD as Se,a8 as N,bG as De}from"./index-980e4b1c.94133bb0.js";import{K as Fe,Y as Me}from"./index-c0727683.7ba43610.js";import{q as $e}from"./debounce-9195c04f.5a898caf.js";var Ve="Expected a function";function X(h,I,b){var t=!0,f=!0;if(typeof h!="function")throw new TypeError(Ve);return Se(b)&&(t="leading"in b?!!b.leading:t,f="trailing"in b?!!b.trailing:f),$e(h,I,{leading:t,maxWait:I,trailing:f})}const Pe=Ce({urlList:{type:ze(Array),default:()=>Ne([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),We={close:()=>!0,switch:h=>j(h)},He=["src"],Qe=K({name:"ElImageViewer"}),Ze=K({...Qe,props:Pe,emits:We,setup(h,{expose:I,emit:b}){const t=h,f={CONTAIN:{name:"contain",icon:W(Ee)},ORIGINAL:{name:"original",icon:W(Xe)}},{t:G}=Fe(),o=Oe("image-viewer"),{nextZIndex:U}=Me(),L=O(),B=O([]),S=ue(),C=O(!0),k=O(t.initialIndex),T=fe(f.CONTAIN),i=O({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),J=w(()=>{const{urlList:e}=t;return e.length<=1}),D=w(()=>k.value===0),F=w(()=>k.value===t.urlList.length-1),ee=w(()=>t.urlList[k.value]),ae=w(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!t.infinite&&D.value)]),ne=w(()=>[o.e("btn"),o.e("next"),o.is("disabled",!t.infinite&&F.value)]),se=w(()=>{const{scale:e,deg:n,offsetX:s,offsetY:r,enableTransition:d}=i.value;let m=s/e,v=r/e;switch(n%360){case 90:case-270:[m,v]=[v,-m];break;case 180:case-180:[m,v]=[-m,-v];break;case 270:case-90:[m,v]=[-v,m];break}const z={transform:`scale(${e}) rotate(${n}deg) translate(${m}px, ${v}px)`,transition:d?"transform .3s":""};return T.value.name===f.CONTAIN.name&&(z.maxWidth=z.maxHeight="100%"),z}),te=w(()=>j(t.zIndex)?t.zIndex:U());function R(){le(),b("close")}function oe(){const e=X(s=>{switch(s.code){case N.esc:t.closeOnPressEscape&&R();break;case N.space:$();break;case N.left:V();break;case N.up:x("zoomIn");break;case N.right:P();break;case N.down:x("zoomOut");break}}),n=X(s=>{const r=s.deltaY||s.deltaX;x(r<0?"zoomIn":"zoomOut",{zoomRate:t.zoomRate,enableTransition:!1})});S.run(()=>{A(document,"keydown",e),A(document,"wheel",n)})}function le(){S.stop()}function ie(){C.value=!1}function re(e){C.value=!1,e.target.alt=G("el.image.error")}function ce(e){if(C.value||e.button!==0||!L.value)return;i.value.enableTransition=!1;const{offsetX:n,offsetY:s}=i.value,r=e.pageX,d=e.pageY,m=X(z=>{i.value={...i.value,offsetX:n+z.pageX-r,offsetY:s+z.pageY-d}}),v=A(document,"mousemove",m);A(document,"mouseup",()=>{v()}),e.preventDefault()}function M(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function $(){if(C.value)return;const e=De(f),n=Object.values(f),s=T.value.name,r=(n.findIndex(d=>d.name===s)+1)%e.length;T.value=f[e[r]],M()}function Y(e){const n=t.urlList.length;k.value=(e+n)%n}function V(){D.value&&!t.infinite||Y(k.value-1)}function P(){F.value&&!t.infinite||Y(k.value+1)}function x(e,n={}){if(C.value)return;const{zoomRate:s,rotateDeg:r,enableTransition:d}={zoomRate:t.zoomRate,rotateDeg:90,enableTransition:!0,...n};switch(e){case"zoomOut":i.value.scale>.2&&(i.value.scale=Number.parseFloat((i.value.scale/s).toFixed(3)));break;case"zoomIn":i.value.scale<7&&(i.value.scale=Number.parseFloat((i.value.scale*s).toFixed(3)));break;case"clockwise":i.value.deg+=r;break;case"anticlockwise":i.value.deg-=r;break}i.value.enableTransition=d}return H(ee,()=>{de(()=>{const e=B.value[0];e!=null&&e.complete||(C.value=!0)})}),H(k,e=>{M(),b("switch",e)}),me(()=>{var e,n;oe(),(n=(e=L.value)==null?void 0:e.focus)==null||n.call(e)}),I({setActiveItem:Y}),(e,n)=>(_(),Q(he,{to:"body",disabled:!e.teleported},[l(xe,{name:"viewer-fade",appear:""},{default:p(()=>[u("div",{ref_key:"wrapper",ref:L,tabindex:-1,class:c(a(o).e("wrapper")),style:Z({zIndex:a(te)})},[u("div",{class:c(a(o).e("mask")),onClick:n[0]||(n[0]=ve(s=>e.hideOnClickModal&&R(),["self"]))},null,2),y(" CLOSE "),u("span",{class:c([a(o).e("btn"),a(o).e("close")]),onClick:R},[l(a(g),null,{default:p(()=>[l(a(_e))]),_:1})],2),y(" ARROW "),a(J)?y("v-if",!0):(_(),E(q,{key:0},[u("span",{class:c(a(ae)),onClick:V},[l(a(g),null,{default:p(()=>[l(a(ye))]),_:1})],2),u("span",{class:c(a(ne)),onClick:P},[l(a(g),null,{default:p(()=>[l(a(Ie))]),_:1})],2)],64)),y(" ACTIONS "),u("div",{class:c([a(o).e("btn"),a(o).e("actions")])},[u("div",{class:c(a(o).e("actions__inner"))},[l(a(g),{onClick:n[1]||(n[1]=s=>x("zoomOut"))},{default:p(()=>[l(a(Te))]),_:1}),l(a(g),{onClick:n[2]||(n[2]=s=>x("zoomIn"))},{default:p(()=>[l(a(Ae))]),_:1}),u("i",{class:c(a(o).e("actions__divider"))},null,2),l(a(g),{onClick:$},{default:p(()=>[(_(),Q(pe(a(T).icon)))]),_:1}),u("i",{class:c(a(o).e("actions__divider"))},null,2),l(a(g),{onClick:n[3]||(n[3]=s=>x("anticlockwise"))},{default:p(()=>[l(a(Le))]),_:1}),l(a(g),{onClick:n[4]||(n[4]=s=>x("clockwise"))},{default:p(()=>[l(a(Re))]),_:1})],2)],2),y(" CANVAS "),u("div",{class:c(a(o).e("canvas"))},[(_(!0),E(q,null,be(e.urlList,(s,r)=>ke((_(),E("img",{ref_for:!0,ref:d=>B.value[r]=d,key:s,src:s,style:Z(a(se)),class:c(a(o).e("img")),onLoad:ie,onError:re,onMousedown:ce},null,46,He)),[[we,r===k.value]])),128))],2),ge(e.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var qe=Be(Ze,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const Je=Ye(qe);export{We as H,Pe as P,Je as Q};
