import{e as V,j as R,p as h,r as P,f as _,o as u,c as S,b,d as k,s as I,u as v,E as $,F as A,k as p,N as D,Y as G,x as K,n as N,m as M,R as E,G as U}from"../app.c22c6c8c.js";import{p as T}from"./icon.vue_vue_type_script_setup_true_lang-cc078b52.fc49277e.js";import{M as j}from"./index.0d7c8eb8.js";import{R as z}from"./vuedraggable.umd-6a5b6da9.404cbac1.js";const w=V({name:"ETreeNodeItem",__name:"treeNodeItem",props:{schema:{}},setup(g){const s=g,o=p("slots",{}),c=p("expandedKeys"),y=p("treeProps"),t=p("selectedKeys"),f=p("handleSelect"),i=_(()=>{var a;return c.value.includes((a=s.schema.id)!=null?a:"")}),n=V({setup(){return()=>{var e;var a;return E("span",{class:{text:!0,hover:y.hoverKey===s.schema.id,checked:t.value.includes(s.schema.id)},onClick:()=>f(s.schema.id,s.schema)},(e=(a=o["tree-node"])==null?void 0:a.call(o,s))!=null?e:E("span",{class:"text-padding"},{default:()=>{var r;var l;return[(r=s.schema.label)!=null?r:(l=j.getComponentConfingByType(s.schema.type))==null?void 0:l.defaultSchema.label,E("span",{class:"epic-node-type-text"},s.schema.type)]}}))}}});function d(){const a=s.schema.id;if(!a)return!1;c.value.includes(a)?c.value=c.value.filter(e=>e!==a):c.value.push(a)}function m(){var a;const e=s.schema.id;if(!e||!((a=s.schema.children)!=null&&a.length))return!1;c.value.push(e)}return m(),(a,e)=>{var l,r,x;return u(),S("li",{class:N(["epic-tree-node",{expanded:(l=s.schema.children)==null?void 0:l.length,"level-1":s.schema.type==="page"}])},[b("a",null,[(r=s.schema.children)!=null&&r.length&&s.schema.type!=="page"?(u(),S("span",{key:0,class:N(["icon-expanded",{expanded:i.value}]),onClick:d},[k(v(T),{name:"icon-youjiantou"})],2)):U("",!0),k(v(n))]),(x=s.schema.children)!=null&&x.length?(u(),K(F,{key:0,class:N(["epic-tree-sublist",{expanded:i.value}]),schemas:s.schema.children,"onUpdate:schemas":e[0]||(e[0]=C=>s.schema.children=C),parentSchema:s.schema},null,8,["class","schemas","parentSchema"])):U("",!0)],2)}}}),H={key:1},F=V({name:"ETreeNodes",__name:"treeNodes",props:{schemas:{},parentSchema:{}},emits:["update:schemas"],setup(g,{emit:s}){const o=g,c=p("designer"),y=p("treeProps"),t=_({get(){return o.schemas},set(n){s("update:schemas",n)}});function f(n){c.setDisableHover(!0),c.setCheckedNode(t.value[n])}function i(n){return n.type==="page"||n.immovable?"unmover-item":"draggable-item"}return(n,d)=>{var m,a;return(m=o.parentSchema)!=null&&m.childImmovable?(u(),S("ul",H,[(u(!0),S(D,null,G(t.value,e=>(u(),K(w,{key:e.id,schema:e},null,8,["schema"]))),128))])):(u(),K(v(z),M({key:0,modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=e=>t.value=e),"item-key":"id","component-data":{},class:"draggable-range"},{animation:200,tag:"ul",group:"tree-draggable",ghostClass:"moveing",draggable:".draggable-item",disabled:!v(y).draggable||((a=t.value[0])==null?void 0:a.type)==="page"},{onStart:d[1]||(d[1]=e=>f(e.oldIndex))}),{item:I(({element:e,index:l})=>[(u(),K(w,{class:N(i(e)),key:e.id,schema:e},null,8,["class","schema"]))]),_:1},16,["modelValue"]))}}}),J={class:"epic-tree"},L={class:"search-box px-10px py-6px"},O={class:"epic-tree-main"},Q={class:"text-center pt-42px text-gray-400"},X=V({name:"ETree",__name:"tree",props:{options:{type:Array,default:()=>[]},hoverKey:{type:String,default:""},selectedKeys:{type:Array,default:()=>[]},draggable:{type:Boolean,default:!1}},emits:["update:selectedKeys","node-click"],setup(g,{emit:s}){const o=g,c=R();h("slots",c);const y=j.getComponent("input"),t=P(""),f=P([]),i=_({get(){return o.selectedKeys},set(a){s("update:selectedKeys",a)}}),n=_({get(){return d(o.options,t.value)},set(a){console.log(a)}});function d(a,e){const l=[];return a.forEach(r=>{var x;if((x=r.label)!=null&&x.includes(e))l.push(r);else if(r.children){const C=d(r.children,e);if(C.length>0){const B={...r};B.children=C,l.push(B)}}}),l}function m(a,e){i.value=[a],s("node-click",{id:a,record:e})}return h("expandedKeys",f),h("selectedKeys",i),h("treeProps",o),h("handleSelect",m),h("handleSelect",m),(a,e)=>(u(),S("div",J,[b("div",L,[k(v(y),{placeholder:"\u641C\u7D22\u8282\u70B9",clearable:"",allowClear:"",modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value=l),value:t.value,"onUpdate:value":e[1]||(e[1]=l=>t.value=l)},{prefix:I(()=>[k(v(T),{name:"icon-chaxun"})]),_:1},8,["modelValue","value"])]),b("div",O,[b("ul",null,[k(F,{schemas:n.value,"onUpdate:schemas":e[2]||(e[2]=l=>n.value=l)},null,8,["schemas"])]),$(b("div",Q,"\u6CA1\u6709\u67E5\u8BE2\u5230\u7684\u6570\u636E",512),[[A,!n.value.length]])])]))}});export{X as Z};
